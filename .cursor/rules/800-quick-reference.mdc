---
description: "Quick Reference Card - Critical Information at a Glance"
alwaysApply: true
globs:
  - "**/*"
---

# Quick Reference Card

## ğŸš¨ Critical Facts (Never Forget)

### Directory Names
- âœ… `chimera_brain` (underscore) - NOT `chimera-brain`
- âœ… `chimera-core` (hyphen) - NOT `chimera_core`
- âœ… `brainscraper` (no hyphen/underscore)
- âœ… `scrapegoat` (no hyphen/underscore)

### Service Communication
- **BrainScraper:** In-memory enrichment â†’ `enriched-all-leads.json` (file system)
- **Scrapegoat:** Redis Queue (`leads_to_enrich`) â†’ PostgreSQL (alternative path)
- **Chimera Core â†” Chimera Brain:** gRPC (`chimera-brain.railway.internal:50051`)
- **Scrapegoat â†’ PostgreSQL:** SQL (queue-based enrichment path)
- **Chimera Brain â†’ Redis:** Hive Mind (Redis Stack, not standard Redis)

### Ports
| Service | HTTP | gRPC | Notes |
|---------|------|------|-------|
| brainscraper | 3000 | - | Next.js |
| scrapegoat | 8000 | - | FastAPI |
| chimera-brain-v1 | 8080 | 50051 | Dual port! |
| chimera-core | - | - | Worker only |

---

## ğŸ¯ Decision Tree (30 Seconds)

**"Where do I make this change?"**

```
Need to modify...
â”œâ”€ Lead discovery UI? â†’ brainscraper/app/components/
â”œâ”€ API endpoint? â†’ brainscraper/app/api/ OR scrapegoat/main.py
â”œâ”€ Enrichment logic? â†’ scrapegoat/app/workers/
â”œâ”€ Vision processing? â†’ chimera_brain/vision_service.py
â”œâ”€ Browser automation? â†’ chimera-core/src/stealth.rs
â”œâ”€ Service communication? â†’ @proto/chimera.proto (update contract first!)
â””â”€ Database schema? â†’ PostgreSQL migration
```

---

## ğŸ”„ Data Flow (Quick)

```
Lead Discovery (Two Paths):
  Path A: User â†’ BrainScraper â†’ In-Memory Enrichment â†’ enriched-all-leads.json â†’ BrainScraper UI
  Path B: API â†’ Scrapegoat â†’ Redis Queue â†’ Scrapegoat Worker â†’ PostgreSQL â†’ BrainScraper UI

Vision Processing:
  Chimera Core â†’ gRPC â†’ Chimera Brain â†’ VLM â†’ Coordinates â†’ Chimera Core

Memory Query:
  Chimera Core â†’ gRPC â†’ Chimera Brain â†’ Redis Stack â†’ Results â†’ Chimera Core
```

---

## âš ï¸ Common Mistakes

1. âŒ Using `chimera-brain` instead of `chimera_brain` (directory)
2. âŒ Mixing code between services (imports)
3. âŒ Using HTTP instead of gRPC for Chimera services
4. âŒ Using standard Redis instead of Redis Stack for Hive Mind
5. âŒ Modifying `/brainscraper/app/api/` without permission
6. âŒ Overwriting enriched leads (always merge!)
7. âŒ Creating new start scripts (use `start-triple-vessel.sh`)

---

## ğŸ“ Key Files

| Purpose | File |
|---------|------|
| Start system | `start-triple-vessel.sh` |
| Debug enrichment (logs+code, AI) | `.cursor/rules/debug-enrichment-with-ai.mdc` |
| People-search readiness + test | `PEOPLE_SEARCH_CHECKLIST.md` Â§ **Final readiness** |
| gRPC contract | `@proto/chimera.proto` |
| Local dev | `docker-compose.yml` |
| Lead discovery | `brainscraper/app/components/LinkedInLeadGenerator.tsx` |
| Enrichment worker | `scrapegoat/start_redis_worker.py` |
| Vision service | `chimera_brain/vision_service.py` |
| Stealth logic | `chimera-core/src/stealth.rs` |

---

## ğŸ”§ Quick Commands

```bash
# Start everything
LOCAL_MODE=true ./start-triple-vessel.sh

# Check health
curl http://localhost:8000/health
curl http://localhost:8080/health

# Check queue
redis-cli LLEN leads_to_enrich

# Check database
psql $DATABASE_URL -c "SELECT COUNT(*) FROM leads;"

# View logs
railway logs --service <name> --tail 50
docker-compose logs -f
```

---

## ğŸ¯ Two Systems (Don't Mix!)

**System 1: Lead Enrichment (Two Paths)**
- **Path A:** BrainScraper â†’ In-Memory Enrichment â†’ `enriched-all-leads.json` (primary)
- **Path B:** Scrapegoat API â†’ Redis Queue â†’ Scrapegoat Worker â†’ PostgreSQL (alternative)
- Both paths coexist but are independent

**System 2: Chimera AI**
- Chimera Brain + Chimera Core
- gRPC + Redis Stack
- For vision processing and browser automation

**Rule:** These coexist but don't directly interact!

---

## ğŸ“š Full Documentation

- **Architecture:** `.cursor/rules/000-mission-alpha.mdc`
- **Operations:** `.cursor/rules/500-system-operations.mdc`
- **Relationships:** `.cursor/rules/600-component-relationships.mdc`
- **Testing:** `.cursor/rules/700-testing-verification.mdc`

---

## ğŸš¨ Emergency Checklist

If something breaks:

1. âœ… Check service health: `curl <service>/health`
2. âœ… Check logs: `railway logs` or `docker-compose logs`
3. âœ… Verify environment variables are set
4. âœ… Check root directories in Railway dashboard
5. âœ… Verify ports aren't conflicting
6. âœ… Check service dependencies (Redis, PostgreSQL)
7. âœ… Verify proto files are generated (for gRPC)

---

## ğŸ’¡ Remember

- **Isolation is critical** - services don't import each other
- **Protocols matter** - Redis for enrichment, gRPC for Chimera
- **Directory names matter** - underscores vs hyphens
- **Data protection** - never overwrite enriched leads
- **Use the start script** - don't create new ones
