[build]
builder = "NIXPACKS"
buildCommand = "pip install -r requirements.txt && playwright install chromium"
# Watch paths are evaluated from repository root, not root directory
# Use explicit path to ensure changes are detected
watchPatterns = [
  "scrapegoat/**"
]

[deploy]
# startCommand: Set per-service in Railway Dashboard
# - scrapegoat (main): python3 main.py
# - scrapegoat-worker-swarm: python start_redis_worker.py
# Note: Config-as-code overrides Dashboard, so Root Directory must be set correctly
healthcheckPath = "/health"
healthcheckTimeout = 300
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

[env]
PYTHONUNBUFFERED = "1"
PORT = "8080"

[environments]
[environments.production]
ENVIRONMENT = "production"
PORT = "8080"